"{ ""cells"": [ { ""cell_type"": ""code"", ""execution_count"": 19, ""metadata"": { ""trusted"": true }, ""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""(7613, 5)\n"" ] }, { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
""" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"id keyword location                                       text                                target"
"Our Deeds are the Reason of this #earthquake"
"0 1 NaN           NaN                                                                            1"
"M..."
"1 4 NaN          NaN         Forest fire near La Ronge Sask. Canada              1"
"2 5 NaN          NaN         All residents asked to 'shelter in place' are ...   1"
"3 6 NaN          NaN         13,000 people receive #wildfires evacuation or...   1"
"4 7 NaN          NaN         Just got sent this photo from Ruby #Alaska as ...   1"
"\n"", """
""" ], ""text/plain"": [ "" id keyword location text \\\n"", ""0 1 NaN NaN Our Deeds are the Reason of this #earthquake M... \n"", ""1 4 NaN NaN Forest fire near La Ronge Sask. Canada \n"", ""2 5 NaN NaN All residents asked to 'shelter"
"in place' are ... \n"", ""3 6 NaN NaN 13,000 people receive #wildfires evacuation or... \n"", ""4 7 NaN NaN Just got sent this photo from Ruby #Alaska as ... \n"", ""\n"", "" target \n"", ""0 1 \n"", ""1 1 \n"", ""2 1 \n"", ""3 1 \n"", ""4 1 "" ] },"
"""execution_count"": 19, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""import pandas as pd\n"", ""data = pd.read_csv(\""train.csv\"")\n"", ""print(data.shape)\n"", ""data.head()\n"", ""\n"" ] }, { ""cell_type"": ""code"","
"""execution_count"": 20, ""metadata"": { ""trusted"": true }, ""outputs"": [ { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAAjEAAAGzCAYAAADe/0a6AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAA9hAAAPYQGoP"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" } ], ""source"": [ ""import matplotlib.pyplot as plt\n"", ""data['text_length'] = data['text'].apply(len)\n"", ""plt.hist(data['text_length'], bins=30)\n"", ""plt.title(\""Tweet Length"
"Distribution\"")\n"", ""plt.show()\n"" ] }, { ""cell_type"": ""code"", ""execution_count"": 21, ""metadata"": { ""trusted"": true }, ""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""id 0\n"", ""keyword 61\n"", ""location"
"2533\n"", ""text 0\n"", ""target 0\n"", ""text_length 0\n"", ""dtype: int64\n"" ] } ], ""source"": [ ""print(data.isnull().sum())\n"" ] }, { ""cell_type"": ""code"", ""execution_count"": 22, ""metadata"": { ""trusted"": true }, ""outputs"": [ { ""name"":"
"""stdout"", ""output_type"": ""stream"", ""text"": [ ""id 0\n"", ""keyword 0\n"", ""location 0\n"", ""text 0\n"", ""target 0\n"", ""text_length 0\n"", ""dtype: int64\n"" ] }, { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAAh8AAAIcCAYAAABWycx/AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAA9hAAAPY"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" }, { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAAjEAAAInCAYAAABp4AhyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAA9hAA"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" }, { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""Training data shape: (6090, 5000)\n"", ""Test data shape: (1523, 5000)\n"" ] } ],"
"""source"": [ ""\n"", ""data['keyword'] = data['keyword'].fillna('missing')\n"", ""data['location'] = data['location'].fillna('unknown')\n"", ""\n"", ""\n"", ""print(data.isnull().sum())\n"", ""\n"", ""\n"", ""keyword_counts ="
"data['keyword'].value_counts()\n"", ""keyword_counts[:10].plot(kind='bar', title='Top 10 Keywords')\n"", ""plt.show()\n"", ""\n"", ""\n"", ""location_counts = data['location'].value_counts()\n"","
"""location_counts[:10].plot(kind='bar', title='Top 10 Locations')\n"", ""plt.show()\n"", ""\n"", ""\n"", ""import re\n"", ""def clean_text(text):\n"", "" text = text.lower()\n"", "" text = re.sub(r'http\\S+', '', text)\n"", """
"text = re.sub(r'[^a-zA-Z\\s]', '', text)\n"", "" text = re.sub(r'\\s+', ' ', text).strip()\n"", "" return text\n"", ""\n"", ""data['clean_text'] = data['text'].apply(clean_text)\n"", ""\n"", ""\n"", ""from"
"sklearn.feature_extraction.text import TfidfVectorizer\n"", ""tfidf = TfidfVectorizer(max_features=5000)\n"", ""X = tfidf.fit_transform(data['clean_text']).toarray()\n"", ""y = data['target']\n"", ""\n"", ""\n"","
"""from sklearn.model_selection import train_test_split\n"", ""X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n"", ""\n"", ""\n"", ""print(\""Training data shape:\"","
"X_train.shape)\n"", ""print(\""Test data shape:\"", X_test.shape)\n"", ""\n"" ] }, { ""cell_type"": ""code"", ""execution_count"": 29, ""metadata"": { ""trusted"": true }, ""outputs"": [ { ""name"": ""stdout"","
"""output_type"": ""stream"", ""text"": [ ""Accuracy: 0.804333552199606\n"", ""Classification Report:\n"", "" precision recall f1-score support\n"", ""\n"", "" 0 0.79 0.89 0.84 874\n"", "" 1 0.82 0.69 0.75 649\n"","
"""\n"", "" accuracy 0.80 1523\n"", "" macro avg 0.81 0.79 0.79 1523\n"", ""weighted avg 0.81 0.80 0.80 1523\n"", ""\n"" ] }, { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAAkwAAAHHCAYAAABN+wdFAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMA"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" } ], ""source"": [ ""from sklearn.linear_model import LogisticRegression\n"", ""from sklearn.metrics import accuracy_score,"
"classification_report, confusion_matrix\n"", ""from sklearn.metrics import ConfusionMatrixDisplay\n"", ""import matplotlib.pyplot as plt\n"", ""\n"", ""\n"", ""logistic_model ="
"LogisticRegression(max_iter=1000, random_state=42)\n"", ""logistic_model.fit(X_train, y_train)\n"", ""\n"", ""\n"", ""y_pred = logistic_model.predict(X_test)\n"", ""\n"", ""\n"","
"""print(\""Accuracy:\"", accuracy_score(y_test, y_pred))\n"", ""print(\""Classification Report:\\n\"", classification_report(y_test, y_pred))\n"", ""\n"", ""\n"","
"""ConfusionMatrixDisplay.from_predictions(y_test, y_pred, display_labels=['Non-Disaster', 'Disaster'], cmap='Blues')\n"", ""plt.title(\""Confusion Matrix - Logistic Regression\"")\n"","
"""plt.show()\n"" ] }, { ""cell_type"": ""code"", ""execution_count"": 31, ""metadata"": { ""trusted"": true }, ""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""Submission file"
"'submission.csv' created successfully!\n"" ] } ], ""source"": [ ""\n"", ""test_data = pd.read_csv(\""test.csv\"")\n"", ""\n"", ""\n"", ""test_data['keyword'] = test_data['keyword'].fillna('missing')\n"","
"""test_data['location'] = test_data['location'].fillna('unknown')\n"", ""test_data['clean_text'] = test_data['text'].apply(clean_text)\n"", ""\n"", ""\n"", ""X_test_final ="
"tfidf.transform(test_data['clean_text']).toarray()\n"", ""\n"", ""\n"", ""test_predictions = logistic_model.predict(X_test_final)\n"", ""\n"", ""submission = pd.DataFrame({'id': test_data['id'],"
"'target': test_predictions})\n"", ""submission.to_csv(\""submission.csv\"", index=False)\n"", ""\n"", ""print(\""Submission file 'submission.csv' created successfully!\"")\n"", ""\n"" ] }, {"
"""cell_type"": ""code"", ""execution_count"": null, ""metadata"": { ""trusted"": true }, ""outputs"": [], ""source"": [] }, { ""cell_type"": ""code"", ""execution_count"": null, ""metadata"": { ""trusted"": true },"
"""outputs"": [], ""source"": [] }, { ""cell_type"": ""code"", ""execution_count"": null, ""metadata"": { ""trusted"": true }, ""outputs"": [], ""source"": [] } ], ""metadata"": { ""kernelspec"": { ""display_name"":"
"""Python (Pyodide)"", ""language"": ""python"", ""name"": ""python"" }, ""language_info"": { ""codemirror_mode"": { ""name"": ""python"", ""version"": 3 }, ""file_extension"": "".py"", ""mimetype"": ""text/x-"
"python"", ""name"": ""python"", ""nbconvert_exporter"": ""python"", ""pygments_lexer"": ""ipython3"", ""version"": ""3.8"" } }, ""nbformat"": 4, ""nbformat_minor"": 4 }"
""
